import{S as qe,i as We,s as ze,e as c,g as _,t as V,h as Qe,a as r,P as Ye,b as te,k as l,Q as Te,l as F,m as Ge,o as I,p as Xe,q as Je,u as Ke,d as se,z as Ve,y as Ue,A as Ze,V as je,W as $e,X as N,B as et,R as tt,n as He}from"./index.6af32dc5.js";import{T as st}from"./Terminal.37e4d8fd.js";function Be(s,i,t){const e=s.slice();return e[23]=i[t],e[24]=i,e[25]=t,e}function Le(s,i,t){const e=s.slice();return e[26]=i[t],e}function Fe(s){let i,t=s[26].address+"",e,g;return{c(){i=c("option"),e=V(t),i.__value=g=s[26].address,i.value=i.__value},m(a,D){te(a,i,D),l(i,e)},p(a,D){D&1&&t!==(t=a[26].address+"")&&Xe(e,t),D&1&&g!==(g=a[26].address)&&(i.__value=g,i.value=i.__value)},d(a){a&&se(i)}}}function nt(s){let i,t,e;return{c(){i=c("button"),i.textContent="Open",r(i,"class","green")},m(g,a){te(g,i,a),t||(e=I(i,"click",s[3]),t=!0)},p:He,d(g){g&&se(i),t=!1,e()}}}function lt(s){let i,t,e;return{c(){i=c("button"),i.textContent="Close",r(i,"class","red")},m(g,a){te(g,i,a),t||(e=I(i,"click",s[3]),t=!0)},p:He,d(g){g&&se(i),t=!1,e()}}}function Pe(s){let i,t,e,g,a,D,E,M;function h(){s[12].call(t,s[24],s[25])}function P(){return s[13](s[23])}return{c(){i=c("div"),t=c("input"),g=_(),a=c("button"),a.textContent="Send",D=_(),r(t,"type","text"),r(t,"placeholder",e=s[23].placeholder),r(t,"class","svelte-dost78"),r(a,"class","green"),r(i,"class","flex nowrap")},m(m,R){te(m,i,R),l(i,t),F(t,s[23].value),l(i,g),l(i,a),l(i,D),E||(M=[I(t,"input",h),I(a,"click",P)],E=!0)},p(m,R){s=m,R&1&&e!==(e=s[23].placeholder)&&r(t,"placeholder",e),R&1&&t.value!==s[23].value&&F(t,s[23].value)},d(m){m&&se(i),E=!1,Ze(M)}}}function it(s){let i,t,e,g,a,D,E,M,h,P,m,R,ne,le,b,Z,H,ie,B,oe,re,ce,C,q,o,p,y,W,z,T,f,v,w,ae,Q,Oe,ke,Se,Y,G,De,pe,we,J,ye,de,Ie,he,ue,Ee,me,j,fe=s[0].feedback.message+"",ve,ge,Me,L,be,xe,X,Ae,$,O,Ce,Ne,K=s[0].clients,k=[];for(let n=0;n<K.length;n+=1)k[n]=Fe(Le(s,K,n));function Re(n,u){return n[0].settings.isOpen?lt:nt}let _e=Re(s),x=_e(s);X=new st({props:{lines:s[0].lines}});let U=s[0].sends,S=[];for(let n=0;n<U.length;n+=1)S[n]=Pe(Be(s,U,n));return{c(){i=c("article"),t=c("aside"),e=c("h2"),e.textContent="Connection Settings",g=_(),a=c("label"),D=V("Clients "),E=c("br"),M=_(),h=c("select");for(let n=0;n<k.length;n+=1)k[n].c();P=_(),m=c("label"),R=V("IP Address"),ne=c("br"),le=_(),b=c("input"),ie=_(),B=c("label"),oe=V("Port"),re=c("br"),ce=_(),C=c("input"),p=_(),y=c("label"),W=V("Expected Delimiter"),z=c("br"),T=_(),f=c("input"),ae=_(),Q=c("div"),Oe=V("Encoding Mode"),ke=c("br"),Se=_(),Y=c("div"),G=c("button"),De=V("ASCII"),we=_(),J=c("button"),ye=V("HEX"),Ie=_(),x.c(),he=_(),ue=c("div"),ue.innerHTML=`<span>Carriage Return [CR] = \\r or \\x0D</span>  <br/> 
      <span>Line Feed [LF] = \\n or \\x0A</span>`,Ee=_(),me=c("div"),j=c("span"),ve=V(fe),Me=_(),L=c("section"),be=c("h2"),be.textContent="Terminal",xe=_(),Qe(X.$$.fragment),Ae=_(),$=c("div");for(let n=0;n<S.length;n+=1)S[n].c();r(h,"class","svelte-dost78"),s[0].settings.client===void 0&&Ye(()=>s[6].call(h)),r(b,"type","text"),r(b,"placeholder",Z=s[0].settings.placeholder.ip),b.disabled=H=s[0].settings.isOpen,r(b,"class","svelte-dost78"),r(C,"type","text"),r(C,"placeholder",q=s[0].settings.placeholder.port),C.disabled=o=s[0].settings.isOpen,r(C,"class","svelte-dost78"),r(f,"type","text"),r(f,"placeholder",v=s[0].settings.placeholder.expectedDelimiter),f.disabled=w=s[0].settings.isOpen,r(f,"class","svelte-dost78"),r(G,"class",pe=s[0].settings.encodingMode==="ascii"?"":"dim"),r(J,"class",de=s[0].settings.encodingMode==="hex"?"":"dim"),r(Y,"class","flex even"),r(ue,"class","dim"),r(j,"class",ge=s[0].feedback.color),r(t,"class","grid svelte-dost78"),r($,"class","grid"),r(L,"class","grid svelte-dost78"),r(i,"class","svelte-dost78")},m(n,u){te(n,i,u),l(i,t),l(t,e),l(t,g),l(t,a),l(a,D),l(a,E),l(a,M),l(a,h);for(let A=0;A<k.length;A+=1)k[A].m(h,null);Te(h,s[0].settings.client),l(t,P),l(t,m),l(m,R),l(m,ne),l(m,le),l(m,b),F(b,s[0].settings.ip),l(t,ie),l(t,B),l(B,oe),l(B,re),l(B,ce),l(B,C),F(C,s[0].settings.port),l(t,p),l(t,y),l(y,W),l(y,z),l(y,T),l(y,f),F(f,s[0].settings.expectedDelimiter),l(t,ae),l(t,Q),l(Q,Oe),l(Q,ke),l(Q,Se),l(Q,Y),l(Y,G),l(G,De),l(Y,we),l(Y,J),l(J,ye),l(t,Ie),x.m(t,null),l(t,he),l(t,ue),l(t,Ee),l(t,me),l(me,j),l(j,ve),l(i,Me),l(i,L),l(L,be),l(L,xe),Ge(X,L,null),l(L,Ae),l(L,$);for(let A=0;A<S.length;A+=1)S[A].m($,null);O=!0,Ce||(Ne=[I(h,"input",s[5]),I(h,"change",s[6]),I(b,"input",s[7]),I(C,"input",s[8]),I(f,"input",s[9]),I(G,"click",s[10]),I(J,"click",s[11])],Ce=!0)},p(n,[u]){if(u&1){K=n[0].clients;let d;for(d=0;d<K.length;d+=1){const ee=Le(n,K,d);k[d]?k[d].p(ee,u):(k[d]=Fe(ee),k[d].c(),k[d].m(h,null))}for(;d<k.length;d+=1)k[d].d(1);k.length=K.length}u&1&&Te(h,n[0].settings.client),(!O||u&1&&Z!==(Z=n[0].settings.placeholder.ip))&&r(b,"placeholder",Z),(!O||u&1&&H!==(H=n[0].settings.isOpen))&&(b.disabled=H),u&1&&b.value!==n[0].settings.ip&&F(b,n[0].settings.ip),(!O||u&1&&q!==(q=n[0].settings.placeholder.port))&&r(C,"placeholder",q),(!O||u&1&&o!==(o=n[0].settings.isOpen))&&(C.disabled=o),u&1&&C.value!==n[0].settings.port&&F(C,n[0].settings.port),(!O||u&1&&v!==(v=n[0].settings.placeholder.expectedDelimiter))&&r(f,"placeholder",v),(!O||u&1&&w!==(w=n[0].settings.isOpen))&&(f.disabled=w),u&1&&f.value!==n[0].settings.expectedDelimiter&&F(f,n[0].settings.expectedDelimiter),(!O||u&1&&pe!==(pe=n[0].settings.encodingMode==="ascii"?"":"dim"))&&r(G,"class",pe),(!O||u&1&&de!==(de=n[0].settings.encodingMode==="hex"?"":"dim"))&&r(J,"class",de),_e===(_e=Re(n))&&x?x.p(n,u):(x.d(1),x=_e(n),x&&(x.c(),x.m(t,he))),(!O||u&1)&&fe!==(fe=n[0].feedback.message+"")&&Xe(ve,fe),(!O||u&1&&ge!==(ge=n[0].feedback.color))&&r(j,"class",ge);const A={};if(u&1&&(A.lines=n[0].lines),X.$set(A),u&17){U=n[0].sends;let d;for(d=0;d<U.length;d+=1){const ee=Be(n,U,d);S[d]?S[d].p(ee,u):(S[d]=Pe(ee),S[d].c(),S[d].m($,null))}for(;d<S.length;d+=1)S[d].d(1);S.length=U.length}},i(n){O||(Je(X.$$.fragment,n),O=!0)},o(n){Ke(X.$$.fragment,n),O=!1},d(n){n&&se(i),Ve(k,n),x.d(),Ue(X),Ve(S,n),Ce=!1,Ze(Ne)}}}function ot(s,i,t){let e,g;je(s,$e,o=>t(15,g=o));const a={isOpen:!1,ip:"192.168.1.246",port:23,address:"New Connection",expectedDelimiter:"\\r",history:[],error:"not a real connection"},D={wasReceived:!0,timestampISO:"0000-00-00T00:00:00.000Z",data:"No data yet..."},E=g.hex_spacer||" ";function M(o){t(0,e.settings.client=o,e),P(),m()}function h(o){t(0,e.settings.encodingMode=o,e),m()}function P(){if(e.settings.client==="New Connection")t(0,e.clientSelected=a,e),t(0,e.settings.isOpen=!1,e),console.log("Interface selected updated to","New Connection");else{const o=e.clients.find(p=>p.address===e.settings.client);t(0,e.clientSelected=o,e),t(0,e.settings.ip=o.ip,e),t(0,e.settings.port=o.port,e),t(0,e.settings.expectedDelimiter=o.expectedDelimiter,e),t(0,e.settings.isOpen=o.isOpen,e),console.log("Interface selected updated to",e.settings)}}function m(){if(e.clientSelected.history.length>0){let o=[];e.settings.encodingMode==="hex"?e.clientSelected.history.forEach(p=>{let y=E!==" "?E:"";if(p.hex!==""){const W=p.hex.match(/.{1,2}/g);y+=W.join(E)}else y="";p.error!==null&&(p.hex+=" <- "+p.error),o.push({wasReceived:p.wasReceived,timestampISO:p.timestampISO,data:y})}):e.clientSelected.history.forEach(p=>{p.error!==null&&(p.ascii+=" <- "+p.error),o.push({wasReceived:p.wasReceived,timestampISO:p.timestampISO,data:p.ascii})}),t(0,e.lines=o,e)}else t(0,e.lines=[D],e)}function R(){e.settings.isOpen?le():(t(0,e.opened=`${e.settings.ip}:${e.settings.port}`,e),ne())}function ne(){const o={ip:e.settings.ip,port:e.settings.port,expectedDelimiter:e.settings.expectedDelimiter};N.send.event("/tcp/client/v1","open",o),console.log("Open Connection",o)}function le(){const o={ip:e.settings.ip,port:e.settings.port};N.send.event("/tcp/client/v1","close",o),console.log("Close Connection",o)}function b(o){const p={ip:e.settings.ip,port:e.settings.port,data:o,encoding:e.settings.encodingMode,cr:!1,lf:!1};N.send.event("/tcp/client/v1","send",p),console.log("Send",p)}N.send.subscribe("/tcp/client/v1"),N.receive.json(o=>{var p;if(o.name==="/tcp/client/v1"){const W=Array.isArray(o.body)?o.body.map(v=>v.address):!1,z=((p=o.body)==null?void 0:p.address)||W,T=o.event,f=o.body;console.log("EVENT",T,"ADDRESS(S)",z,"BODY",f),T==="getClients"?e.clients[1].error==="not a real connection"?(t(0,e.clients=[a],e),f.forEach(v=>{t(0,e.clients=[...e.clients,v],e)})):(e.clients.forEach(v=>{const w=f.find(ae=>v.address===ae.address);console.log("newData",w),w!==void 0&&(v.isOpen=w.isOpen,v.ip=w.ip,v.port=w.port,v.error=w.error,v.history=w.history,v.expectedDelimiter=w.expectedDelimiter)}),t(0,e),P(),m()):T==="open"?f.isOpen===!0&&(t(0,e.feedback={message:`Client ${z} opened`,color:"green"},e),N.send.event("/tcp/client/v1","getClients"),f.address===e.opened&&(console.log("I opened this client",f),M(f.address))):T==="close"?f.isOpen===!1&&(t(0,e.feedback={message:`Client ${z} closed`,color:"red"},e),N.send.event("/tcp/client/v1","getClients"),f.address===e.settings.client&&M("New Connection")):T==="send"?N.send.event("/tcp/client/v1","getClients"):T==="receive"&&N.send.event("/tcp/client/v1","getClients")}}),et(async()=>{N.send.event("/tcp/client/v1","getClients")});const Z=o=>M(o.target.value);function H(){e.settings.client=tt(this),t(0,e)}function ie(){e.settings.ip=this.value,t(0,e)}function B(){e.settings.port=this.value,t(0,e)}function oe(){e.settings.expectedDelimiter=this.value,t(0,e)}const re=()=>h("ascii"),ce=()=>h("hex");function C(o,p){o[p].value=this.value,t(0,e)}const q=o=>b(o.value);return t(0,e={clientSelected:a,clients:[{isOpen:!1,ip:"192.168.1.1",port:23,address:"New Connection",expectedDelimiter:"\\r\\n",history:[],error:"not a real connection"},{isOpen:!1,ip:"192.168.1.9",port:5e3,address:"192.168.1.9:5000",expectedDelimiter:"\\r\\n",history:[],error:"not a real connection"},{isOpen:!0,ip:"192.168.246",port:23,address:"192.168.1.246:23",expectedDelimiter:"\\r",history:[{wasReceived:!1,timestampISO:"2022-12-24T13:37:26.915Z",hex:"4d563f0d",ascii:"MV?\r",buffer:{type:"Buffer",data:[77,86,63,13]},error:null,address:"192.168.1.246:23"},{wasReceived:!0,timestampISO:"2022-12-24T13:37:26.949Z",hex:"4d5634300d",ascii:"MV40\r",buffer:{type:"Buffer",data:[77,86,52,48,13]},error:null,address:"192.168.1.246:23"},{wasReceived:!0,timestampISO:"2022-12-24T13:37:26.997Z",hex:"4d564d41582039380d",ascii:"MVMAX 98\r",buffer:{type:"Buffer",data:[77,86,77,65,88,32,57,56,13]},error:null,address:"192.168.1.246:23"}],error:"not a real connection"}],feedback:{message:"",color:"dim"},opened:"",settings:{client:"New Connection",isOpen:!1,ip:"192.168.1.42",port:5e3,expectedDelimiter:"\\r\\n",encodingMode:"ascii",placeholder:{ip:"192.168.1.9",port:23,expectedDelimiter:"\\r\\n"}},lines:[D],sends:[{value:"MV?\\r",placeholder:"ka 01 01\\r"},{value:"ka 01 00\\r",placeholder:"\xAA\xFE"},{value:"mc 01 02\\r",placeholder:"0A0A0CC203D60001s\r"}]}),[e,M,h,R,b,Z,H,ie,B,oe,re,ce,C,q]}class at extends qe{constructor(i){super(),We(this,i,ot,it,ze,{})}}export{at as default};
