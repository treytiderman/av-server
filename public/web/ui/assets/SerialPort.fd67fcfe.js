import{S as Ae,i as Fe,s as Le,e as c,g as f,t as A,h as qe,a as u,P as Be,b as V,k as i,Q as Re,l as te,m as He,o as x,q as je,u as ze,d as X,z as ae,y as Ne,A as Ee,B as Qe,p as Te,O as Ve,R as Xe,n as ye}from"./index.6af32dc5.js";import{T as Ze}from"./Terminal.37e4d8fd.js";function Me(t,e,l){const s=t.slice();return s[12]=e[l],s[13]=e,s[14]=l,s}function De(t,e,l){const s=t.slice();return s[15]=e[l],s}function xe(t,e,l){const s=t.slice();return s[18]=e[l],s}function we(t){let e,l=t[18].path+"",s,r;return{c(){e=c("option"),s=A(l),e.__value=r=t[18].path,e.value=e.__value},m(o,_){V(o,e,_),i(e,s)},p(o,_){_&1&&l!==(l=o[18].path+"")&&Te(s,l),_&1&&r!==(r=o[18].path)&&(e.__value=r,e.value=e.__value)},d(o){o&&X(e)}}}function Ie(t){let e,l=t[15]+"",s,r;return{c(){e=c("option"),s=A(l),e.__value=r=t[15],e.value=e.__value},m(o,_){V(o,e,_),i(e,s)},p(o,_){_&1&&l!==(l=o[15]+"")&&Te(s,l),_&1&&r!==(r=o[15])&&(e.__value=r,e.value=e.__value)},d(o){o&&X(e)}}}function $e(t){let e,l,s;return{c(){e=c("button"),e.textContent="Open",u(e,"class","green")},m(r,o){V(r,e,o),l||(s=x(e,"click",t[2]),l=!0)},p:ye,d(r){r&&X(e),l=!1,s()}}}function Ge(t){let e,l,s;return{c(){e=c("button"),e.textContent="Close",u(e,"class","red")},m(r,o){V(r,e,o),l||(s=x(e,"click",t[2]),l=!0)},p:ye,d(r){r&&X(e),l=!1,s()}}}function Pe(t){let e,l,s,r,o,_,w,F;function S(){t[8].call(l,t[13],t[14])}return{c(){e=c("div"),l=c("input"),r=f(),o=c("button"),o.textContent="Send",_=f(),u(l,"type","text"),u(l,"placeholder",s=t[12].placeholder),u(l,"class","svelte-pga3e4"),u(o,"class","green"),u(e,"class","flex nowrap")},m(O,D){V(O,e,D),i(e,l),te(l,t[12].value),i(e,r),i(e,o),i(e,_),w||(F=[x(l,"input",S),x(o,"click",function(){Ve(t[3](t[12].value))&&t[3](t[12].value).apply(this,arguments)})],w=!0)},p(O,D){t=O,D&1&&s!==(s=t[12].placeholder)&&u(l,"placeholder",s),D&1&&l.value!==t[12].value&&te(l,t[12].value)},d(O){O&&X(e),w=!1,Ee(F)}}}function Je(t){let e,l,s,r,o,_,w,F,S,O,D,I,h,R,L,d,$,oe,B,ce,re,de,k,G,J,ue,H,pe,_e,fe,j,P,he,K,U,ge,E,ve,W,Y,be,le,ne,me,T,se,Se,q,Oe,Z,C,ie,ke,z=t[0].serialports,g=[];for(let n=0;n<z.length;n+=1)g[n]=we(xe(t,z,n));let N=t[0].baudRates,v=[];for(let n=0;n<N.length;n+=1)v[n]=Ie(De(t,N,n));function Ce(n,p){return n[0].serialportSelected.isOpen?Ge:$e}let ee=Ce(t),M=ee(t);q=new Ze({props:{lines:t[0].lines}});let Q=t[0].sends,b=[];for(let n=0;n<Q.length;n+=1)b[n]=Pe(Me(t,Q,n));return{c(){e=c("article"),l=c("aside"),s=c("h2"),s.textContent="Connection Settings",r=f(),o=c("label"),_=A("Device"),w=c("br"),F=f(),S=c("select");for(let n=0;n<g.length;n+=1)g[n].c();D=f(),I=c("label"),h=A("Baud Rate"),R=c("br"),L=f(),d=c("select");for(let n=0;n<v.length;n+=1)v[n].c();oe=f(),B=c("label"),ce=A("Expected Delimiter"),re=c("br"),de=f(),k=c("input"),ue=f(),H=c("div"),pe=A("Encoding Mode"),_e=c("br"),fe=f(),j=c("div"),P=c("button"),he=A("ASCII"),ge=f(),E=c("button"),ve=A("HEX"),be=f(),M.c(),le=f(),ne=c("div"),ne.innerHTML=`<span class="dim">Carriage Return [CR] = \\r or \\x0D</span>  <br/> 
      <span class="dim">Line Feed [LF] = \\n or \\x0A</span>`,me=f(),T=c("section"),se=c("h2"),se.textContent="Terminal",Se=f(),qe(q.$$.fragment),Oe=f(),Z=c("div");for(let n=0;n<b.length;n+=1)b[n].c();S.disabled=O=t[0].serialportSelected.isOpen,u(S,"class","svelte-pga3e4"),d.disabled=$=t[0].serialportSelected.isOpen,u(d,"class","svelte-pga3e4"),t[0].settings.baudRate===void 0&&Be(()=>t[4].call(d)),u(k,"type","text"),u(k,"placeholder",G=t[0].settings.placeholder.expectedDelimiter),k.disabled=J=t[0].serialportSelected.isOpen,u(k,"class","svelte-pga3e4"),u(P,"class",K=t[0].settings.encodingMode==="ascii"?"":"dim"),P.disabled=U=t[0].serialportSelected.isOpen,u(E,"class",W=t[0].settings.encodingMode==="hex"?"":"dim"),E.disabled=Y=t[0].serialportSelected.isOpen,u(j,"class","flex even"),u(l,"class","grid svelte-pga3e4"),u(Z,"class","grid"),u(T,"class","grid svelte-pga3e4"),u(e,"class","svelte-pga3e4")},m(n,p){V(n,e,p),i(e,l),i(l,s),i(l,r),i(l,o),i(o,_),i(o,w),i(o,F),i(o,S);for(let m=0;m<g.length;m+=1)g[m].m(S,null);i(l,D),i(l,I),i(I,h),i(I,R),i(I,L),i(I,d);for(let m=0;m<v.length;m+=1)v[m].m(d,null);Re(d,t[0].settings.baudRate),i(l,oe),i(l,B),i(B,ce),i(B,re),i(B,de),i(B,k),te(k,t[0].settings.expectedDelimiter),i(l,ue),i(l,H),i(H,pe),i(H,_e),i(H,fe),i(H,j),i(j,P),i(P,he),i(j,ge),i(j,E),i(E,ve),i(l,be),M.m(l,null),i(l,le),i(l,ne),i(e,me),i(e,T),i(T,se),i(T,Se),He(q,T,null),i(T,Oe),i(T,Z);for(let m=0;m<b.length;m+=1)b[m].m(Z,null);C=!0,ie||(ke=[x(S,"input",t[1]),x(d,"change",t[4]),x(k,"input",t[5]),x(P,"click",t[6]),x(E,"click",t[7])],ie=!0)},p(n,[p]){if(p&1){z=n[0].serialports;let a;for(a=0;a<z.length;a+=1){const y=xe(n,z,a);g[a]?g[a].p(y,p):(g[a]=we(y),g[a].c(),g[a].m(S,null))}for(;a<g.length;a+=1)g[a].d(1);g.length=z.length}if((!C||p&1&&O!==(O=n[0].serialportSelected.isOpen))&&(S.disabled=O),p&1){N=n[0].baudRates;let a;for(a=0;a<N.length;a+=1){const y=De(n,N,a);v[a]?v[a].p(y,p):(v[a]=Ie(y),v[a].c(),v[a].m(d,null))}for(;a<v.length;a+=1)v[a].d(1);v.length=N.length}(!C||p&1&&$!==($=n[0].serialportSelected.isOpen))&&(d.disabled=$),p&1&&Re(d,n[0].settings.baudRate),(!C||p&1&&G!==(G=n[0].settings.placeholder.expectedDelimiter))&&u(k,"placeholder",G),(!C||p&1&&J!==(J=n[0].serialportSelected.isOpen))&&(k.disabled=J),p&1&&k.value!==n[0].settings.expectedDelimiter&&te(k,n[0].settings.expectedDelimiter),(!C||p&1&&K!==(K=n[0].settings.encodingMode==="ascii"?"":"dim"))&&u(P,"class",K),(!C||p&1&&U!==(U=n[0].serialportSelected.isOpen))&&(P.disabled=U),(!C||p&1&&W!==(W=n[0].settings.encodingMode==="hex"?"":"dim"))&&u(E,"class",W),(!C||p&1&&Y!==(Y=n[0].serialportSelected.isOpen))&&(E.disabled=Y),ee===(ee=Ce(n))&&M?M.p(n,p):(M.d(1),M=ee(n),M&&(M.c(),M.m(l,le)));const m={};if(p&1&&(m.lines=n[0].lines),q.$set(m),p&9){Q=n[0].sends;let a;for(a=0;a<Q.length;a+=1){const y=Me(n,Q,a);b[a]?b[a].p(y,p):(b[a]=Pe(y),b[a].c(),b[a].m(Z,null))}for(;a<b.length;a+=1)b[a].d(1);b.length=Q.length}},i(n){C||(je(q.$$.fragment,n),C=!0)},o(n){ze(q.$$.fragment,n),C=!1},d(n){n&&X(e),ae(g,n),ae(v,n),M.d(),Ne(q),ae(b,n),ie=!1,Ee(ke)}}}async function Ke(t,e,l){console.log("Open Connection",{path:t,baudRate:e,delimiter:l})}async function Ue(t){console.log("Close Connection",{path:t})}function We(t,e,l){let s={baudRates:[9600,14400,19200,38400,57600,115200],serialports:[{path:"COM3"},{path:"COM4"}],serialportSelected:{path:"COM3",isOpen:!1,baudRate:9600,delimiter:`\r
`,tx:[],txFail:[],rx:[],rxRaw:[],error:null,portObj:"for server use only"},settings:{devicePath:"COM3",baudRate:9600,expectedDelimiter:"\\r\\n",encodingMode:"ascii",isOpen:!1,placeholder:{baudRate:9600,expectedDelimiter:"\\r\\n"}},lines:[{wasReceived:!0,timestampISO:"2022-10-16T21:05:38.425Z",data:"No data yet..."}],sends:[{value:"ka 01 01\\r",placeholder:"ka 01 01\\r"},{value:"ka 01 00\\r",placeholder:"\xAA\xFE"},{value:"mc 01 02\\r",placeholder:"0A0A0CC203D60001s\r"}]};function r(h){const R=h.target.value;l(0,s.nicSelected=s.nics.find(L=>L.name===R),s),console.log("Interface selected changed to",R,s.nicSelected)}async function o(){s.serialportSelected.isOpen?Ue(s.serialportSelected.path):Ke(s.settings.devicePath,s.settings.baudRate,s.settings.expectedDelimiter)}async function _(h){const R={path:s.settings.devicePath,message:h,messageType:s.settings.encodingMode,cr:!1,lf:!1};console.log("Send",R)}function w(h,R){if(h!=null&&h.data){let L=[];R==="hex"?h.data.forEach(d=>{d.error!==""&&(d.hex+=" <- "+d.error),L.push({wasReceived:d.wasReceived,timestampISO:d.timestampISO,data:d.hex})}):h.data.forEach(d=>{d.error!==""&&(d.ascii+=" <- "+d.error),L.push({wasReceived:d.wasReceived,timestampISO:d.timestampISO,data:d.ascii})})}}Qe(async()=>{});function F(){s.settings.baudRate=Xe(this),l(0,s)}function S(){s.settings.expectedDelimiter=this.value,l(0,s)}const O=()=>l(0,s.settings.encodingMode="ascii",s),D=()=>l(0,s.settings.encodingMode="hex",s);function I(h,R){h[R].value=this.value,l(0,s)}return t.$$.update=()=>{t.$$.dirty&1&&w(s.settings.devicePath,s.settings.encodingMode)},[s,r,o,_,F,S,O,D,I]}class tt extends Ae{constructor(e){super(),Fe(this,e,We,Je,Le,{})}}export{tt as default};
