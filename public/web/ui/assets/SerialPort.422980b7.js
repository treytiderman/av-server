import{S as Le,i as Te,s as Ae,e as c,c as f,t as L,f as je,a as u,L as qe,b as X,h as i,M as Re,j as te,m as He,l as x,o as Ne,q as Be,d as Z,w as ae,v as Ke,x as Pe,y as Ve,k as ye,K as Xe,N as Ze,n as Fe}from"./index.eedbf297.js";import $e from"./Terminal.8a9dcca8.js";function Me(t,e,l){const s=t.slice();return s[12]=e[l],s[13]=e,s[14]=l,s}function De(t,e,l){const s=t.slice();return s[15]=e[l],s}function xe(t,e,l){const s=t.slice();return s[18]=e[l],s}function we(t){let e,l=t[18].path+"",s,r;return{c(){e=c("option"),s=L(l),e.__value=r=t[18].path,e.value=e.__value},m(o,_){X(o,e,_),i(e,s)},p(o,_){_&1&&l!==(l=o[18].path+"")&&ye(s,l),_&1&&r!==(r=o[18].path)&&(e.__value=r,e.value=e.__value)},d(o){o&&Z(e)}}}function Ie(t){let e,l=t[15]+"",s,r;return{c(){e=c("option"),s=L(l),e.__value=r=t[15],e.value=e.__value},m(o,_){X(o,e,_),i(e,s)},p(o,_){_&1&&l!==(l=o[15]+"")&&ye(s,l),_&1&&r!==(r=o[15])&&(e.__value=r,e.value=e.__value)},d(o){o&&Z(e)}}}function ze(t){let e,l,s;return{c(){e=c("button"),e.textContent="Open",u(e,"class","green")},m(r,o){X(r,e,o),l||(s=x(e,"click",t[2]),l=!0)},p:Fe,d(r){r&&Z(e),l=!1,s()}}}function Ge(t){let e,l,s;return{c(){e=c("button"),e.textContent="Close",u(e,"class","red")},m(r,o){X(r,e,o),l||(s=x(e,"click",t[2]),l=!0)},p:Fe,d(r){r&&Z(e),l=!1,s()}}}function Ee(t){let e,l,s,r,o,_,w,T;function S(){t[8].call(l,t[13],t[14])}return{c(){e=c("div"),l=c("input"),r=f(),o=c("button"),o.textContent="Send",_=f(),u(l,"type","text"),u(l,"placeholder",s=t[12].placeholder),u(l,"class","svelte-pga3e4"),u(o,"class","green"),u(e,"class","flex nowrap")},m(O,D){X(O,e,D),i(e,l),te(l,t[12].value),i(e,r),i(e,o),i(e,_),w||(T=[x(l,"input",S),x(o,"click",function(){Xe(t[3](t[12].value))&&t[3](t[12].value).apply(this,arguments)})],w=!0)},p(O,D){t=O,D&1&&s!==(s=t[12].placeholder)&&u(l,"placeholder",s),D&1&&l.value!==t[12].value&&te(l,t[12].value)},d(O){O&&Z(e),w=!1,Pe(T)}}}function Je(t){let e,l,s,r,o,_,w,T,S,O,D,I,h,R,A,d,z,oe,q,ce,re,de,k,G,J,ue,H,pe,_e,fe,N,E,he,Q,U,ge,P,ve,W,Y,be,le,ne,me,y,se,Se,j,Oe,$,C,ie,ke,B=t[0].serialports,g=[];for(let n=0;n<B.length;n+=1)g[n]=we(xe(t,B,n));let K=t[0].baudRates,v=[];for(let n=0;n<K.length;n+=1)v[n]=Ie(De(t,K,n));function Ce(n,p){return n[0].serialportSelected.isOpen?Ge:ze}let ee=Ce(t),M=ee(t);j=new $e({props:{lines:t[0].lines}});let V=t[0].sends,b=[];for(let n=0;n<V.length;n+=1)b[n]=Ee(Me(t,V,n));return{c(){e=c("article"),l=c("aside"),s=c("h2"),s.textContent="Connection Settings",r=f(),o=c("label"),_=L("Device"),w=c("br"),T=f(),S=c("select");for(let n=0;n<g.length;n+=1)g[n].c();D=f(),I=c("label"),h=L("Baud Rate"),R=c("br"),A=f(),d=c("select");for(let n=0;n<v.length;n+=1)v[n].c();oe=f(),q=c("label"),ce=L("Expected Delimiter"),re=c("br"),de=f(),k=c("input"),ue=f(),H=c("div"),pe=L("Encoding Mode"),_e=c("br"),fe=f(),N=c("div"),E=c("button"),he=L("ASCII"),ge=f(),P=c("button"),ve=L("HEX"),be=f(),M.c(),le=f(),ne=c("div"),ne.innerHTML=`<span class="dim">Carriage Return [CR] = \\r or \\x0D</span>  <br/> 
      <span class="dim">Line Feed [LF] = \\n or \\x0A</span>`,me=f(),y=c("section"),se=c("h2"),se.textContent="Terminal",Se=f(),je(j.$$.fragment),Oe=f(),$=c("div");for(let n=0;n<b.length;n+=1)b[n].c();S.disabled=O=t[0].serialportSelected.isOpen,u(S,"class","svelte-pga3e4"),d.disabled=z=t[0].serialportSelected.isOpen,u(d,"class","svelte-pga3e4"),t[0].settings.baudRate===void 0&&qe(()=>t[4].call(d)),u(k,"type","text"),u(k,"placeholder",G=t[0].settings.placeholder.expectedDelimiter),k.disabled=J=t[0].serialportSelected.isOpen,u(k,"class","svelte-pga3e4"),u(E,"class",Q=t[0].settings.encodingMode==="ascii"?"":"dim"),E.disabled=U=t[0].serialportSelected.isOpen,u(P,"class",W=t[0].settings.encodingMode==="hex"?"":"dim"),P.disabled=Y=t[0].serialportSelected.isOpen,u(N,"class","flex even"),u(l,"class","grid svelte-pga3e4"),u($,"class","grid"),u(y,"class","grid svelte-pga3e4"),u(e,"class","svelte-pga3e4")},m(n,p){X(n,e,p),i(e,l),i(l,s),i(l,r),i(l,o),i(o,_),i(o,w),i(o,T),i(o,S);for(let m=0;m<g.length;m+=1)g[m].m(S,null);i(l,D),i(l,I),i(I,h),i(I,R),i(I,A),i(I,d);for(let m=0;m<v.length;m+=1)v[m].m(d,null);Re(d,t[0].settings.baudRate),i(l,oe),i(l,q),i(q,ce),i(q,re),i(q,de),i(q,k),te(k,t[0].settings.expectedDelimiter),i(l,ue),i(l,H),i(H,pe),i(H,_e),i(H,fe),i(H,N),i(N,E),i(E,he),i(N,ge),i(N,P),i(P,ve),i(l,be),M.m(l,null),i(l,le),i(l,ne),i(e,me),i(e,y),i(y,se),i(y,Se),He(j,y,null),i(y,Oe),i(y,$);for(let m=0;m<b.length;m+=1)b[m].m($,null);C=!0,ie||(ke=[x(S,"input",t[1]),x(d,"change",t[4]),x(k,"input",t[5]),x(E,"click",t[6]),x(P,"click",t[7])],ie=!0)},p(n,[p]){if(p&1){B=n[0].serialports;let a;for(a=0;a<B.length;a+=1){const F=xe(n,B,a);g[a]?g[a].p(F,p):(g[a]=we(F),g[a].c(),g[a].m(S,null))}for(;a<g.length;a+=1)g[a].d(1);g.length=B.length}if((!C||p&1&&O!==(O=n[0].serialportSelected.isOpen))&&(S.disabled=O),p&1){K=n[0].baudRates;let a;for(a=0;a<K.length;a+=1){const F=De(n,K,a);v[a]?v[a].p(F,p):(v[a]=Ie(F),v[a].c(),v[a].m(d,null))}for(;a<v.length;a+=1)v[a].d(1);v.length=K.length}(!C||p&1&&z!==(z=n[0].serialportSelected.isOpen))&&(d.disabled=z),p&1&&Re(d,n[0].settings.baudRate),(!C||p&1&&G!==(G=n[0].settings.placeholder.expectedDelimiter))&&u(k,"placeholder",G),(!C||p&1&&J!==(J=n[0].serialportSelected.isOpen))&&(k.disabled=J),p&1&&k.value!==n[0].settings.expectedDelimiter&&te(k,n[0].settings.expectedDelimiter),(!C||p&1&&Q!==(Q=n[0].settings.encodingMode==="ascii"?"":"dim"))&&u(E,"class",Q),(!C||p&1&&U!==(U=n[0].serialportSelected.isOpen))&&(E.disabled=U),(!C||p&1&&W!==(W=n[0].settings.encodingMode==="hex"?"":"dim"))&&u(P,"class",W),(!C||p&1&&Y!==(Y=n[0].serialportSelected.isOpen))&&(P.disabled=Y),ee===(ee=Ce(n))&&M?M.p(n,p):(M.d(1),M=ee(n),M&&(M.c(),M.m(l,le)));const m={};if(p&1&&(m.lines=n[0].lines),j.$set(m),p&9){V=n[0].sends;let a;for(a=0;a<V.length;a+=1){const F=Me(n,V,a);b[a]?b[a].p(F,p):(b[a]=Ee(F),b[a].c(),b[a].m($,null))}for(;a<b.length;a+=1)b[a].d(1);b.length=V.length}},i(n){C||(Ne(j.$$.fragment,n),C=!0)},o(n){Be(j.$$.fragment,n),C=!1},d(n){n&&Z(e),ae(g,n),ae(v,n),M.d(),Ke(j),ae(b,n),ie=!1,Pe(ke)}}}async function Qe(t,e,l){console.log("Open Connection",{path:t,baudRate:e,delimiter:l})}async function Ue(t){console.log("Close Connection",{path:t})}function We(t,e,l){let s={baudRates:[9600,14400,19200,38400,57600,115200],serialports:[{path:"COM3"},{path:"COM4"}],serialportSelected:{path:"COM3",isOpen:!1,baudRate:9600,delimiter:`\r
`,tx:[],txFail:[],rx:[],rxRaw:[],error:null,portObj:"for server use only"},settings:{devicePath:"COM3",baudRate:9600,expectedDelimiter:"\\r\\n",encodingMode:"ascii",isOpen:!1,placeholder:{baudRate:9600,expectedDelimiter:"\\r\\n"}},lines:[{wasReceived:!0,timestampISO:"2022-10-16T21:05:38.425Z",data:"No data yet..."}],sends:[{value:"ka 01 01\\r",placeholder:"ka 01 01\\r"},{value:"ka 01 00\\r",placeholder:"\xAA\xFE"},{value:"mc 01 02\\r",placeholder:"0A0A0CC203D60001s\r"}]};function r(h){const R=h.target.value;l(0,s.nicSelected=s.nics.find(A=>A.name===R),s),console.log("Interface selected changed to",R,s.nicSelected)}async function o(){s.serialportSelected.isOpen?Ue(s.serialportSelected.path):Qe(s.settings.devicePath,s.settings.baudRate,s.settings.expectedDelimiter)}async function _(h){const R={path:s.settings.devicePath,message:h,messageType:s.settings.encodingMode,cr:!1,lf:!1};console.log("Send",R)}function w(h,R){if(h!=null&&h.data){let A=[];R==="hex"?h.data.forEach(d=>{d.error!==""&&(d.hex+=" <- "+d.error),A.push({wasReceived:d.wasReceived,timestampISO:d.timestampISO,data:d.hex})}):h.data.forEach(d=>{d.error!==""&&(d.ascii+=" <- "+d.error),A.push({wasReceived:d.wasReceived,timestampISO:d.timestampISO,data:d.ascii})})}}Ve(async()=>{});function T(){s.settings.baudRate=Ze(this),l(0,s)}function S(){s.settings.expectedDelimiter=this.value,l(0,s)}const O=()=>l(0,s.settings.encodingMode="ascii",s),D=()=>l(0,s.settings.encodingMode="hex",s);function I(h,R){h[R].value=this.value,l(0,s)}return t.$$.update=()=>{t.$$.dirty&1&&w(s.settings.devicePath,s.settings.encodingMode)},[s,r,o,_,T,S,O,D,I]}class tt extends Le{constructor(e){super(),Te(this,e,We,Je,Ae,{})}}export{tt as default};
